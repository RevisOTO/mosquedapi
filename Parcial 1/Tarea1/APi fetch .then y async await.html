<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <a>Api Text To Speech, escriba algo y descargue su archivo</a>
    <br>
    <button id="audio">Presione para el fetch (Fetch con async y await)</button>
    <input id="texto" type="text" placeholder="">
    <a href="" id="Voice" style="display:none ;"> Link de su linea de voz </a>
    <br>
    <button id="buttonFox">Presione aqui para un zorrito (Fetch con .then)</button>
    <br>
    <img width="300px" id="img">
    <br>
    <div class="container" width="200px" >
        <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <img id="im0" class="d-block w-100" src="..." alt="First slide" width="200px" height="400px">
              </div>
              <div class="carousel-item">
                <img id="im1" class="d-block w-100" src="..." alt="Second slide" width="200px" height="400px">
              </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a id="sig" class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>`
    </div>
    
      <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>

</html>

<script>
    window.onload = function(){
        document.getElementById("audio").addEventListener("click", async function(){
            command = document.getElementById("texto").value
            document.getElementById("Voice").style = "display:none ;"
            if(command == null){
                return
            }
            let dato = await getFetchVoice(command)
        });


        document.getElementById("buttonFox").addEventListener("click", function(){
            for(i=0; i <= 1; i++){
                name = "im"+i
                getFetchFOX(name)
            }
        })

        url2 = ""

        async function getFetchVoice(command){
            const options = {
                method: 'POST',
                headers: {
                  Accept: 'application/json',
                  'uberduck-id': 'anonymous',
                  'Content-Type': 'application/json',
                  Authorization: 'Basic cHViX2NhY2h4eXhpaWpwZnh1dWRlcDpwa180MjYxMDZjYy0xNWQ2LTQwNjctYTUyYi00YjgyOTEyOGU0NTU='
                },
                body: JSON.stringify({voice: 'fernanfloo', pace: 1, speech: command})
              };
              
              let response = await fetch('https://api.uberduck.ai/speak', options)
              
              let response1 = await response.json()
              console.log(response1)
              
              let respones2 = 'https://api.uberduck.ai/speak-status?uuid='+ response1.uuid
              console.log(respones2)

              url = await fetch(respones2)
              download = await url.json()

              while (download.path == null){
                setTimeout(() => { console.log("Esperando..."); }, 5000);
                url = await fetch(respones2)
                download = await url.json()
                console.log(download.path)
              }
              document.getElementById("Voice").href = download.path
              document.getElementById("Voice").style = ""
              document.getElementById("Voice").style = "display:flex ;"


        }
        
        function getFetchFOX(name){
            fetch('https://randomfox.ca/floof/')
                .then(response => response.json())
                .then(datos => document.getElementById(name).src = datos.image)
        }
    }
</script>